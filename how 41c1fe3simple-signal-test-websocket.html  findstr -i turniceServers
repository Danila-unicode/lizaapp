[33mcommit 41c1fe3cb969e5fc6b0fb7c93a7e90186a11b44d[m[33m ([m[1;36mHEAD[m[33m -> [m[1;32mmaster[m[33m, [m[1;31morigin/master[m[33m)[m
Author: unico <unicode23@gmail.com>
Date:   Sat Sep 13 12:05:27 2025 +0300

    –£–ø—Ä–æ—â–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞: —Å–∫—Ä—ã—Ç—ã –∫–Ω–æ–ø–∫–∏ '–û—Ç–ø—Ä–∞–≤–∏—Ç—å ping', '–°–±—Ä–æ—Å–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ' –∏ '–°–≤—è–∑—å'

[1mdiff --git a/simple-signal-test-websocket.html b/simple-signal-test-websocket.html[m
[1mindex 6f080cc..3db59eb 100644[m
[1m--- a/simple-signal-test-websocket.html[m
[1m+++ b/simple-signal-test-websocket.html[m
[36m@@ -27,12 +27,12 @@[m
             <input type="text" id="user1Id" value="user1" placeholder="User ID">[m
             <input type="text" id="user1Target" value="user2" placeholder="–¶–µ–ª–µ–≤–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å">[m
             <button onclick="startUser1()">–ó–∞–ø—É—Å—Ç–∏—Ç—å User 1</button>[m
[31m-            <button onclick="sendPingToTarget('user1')">–û—Ç–ø—Ä–∞–≤–∏—Ç—å ping –∫ —Ü–µ–ª–µ–≤–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é</button>[m
[31m-            <button onclick="resetUser1()" style="background: #ff9800; color: white;">üîÑ –°–±—Ä–æ—Å–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ</button>[m
[32m+[m[32m            <button onclick="sendPingToTarget('user1')" style="display: none;">–û—Ç–ø—Ä–∞–≤–∏—Ç—å ping –∫ —Ü–µ–ª–µ–≤–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é</button>[m
[32m+[m[32m            <button onclick="resetUser1()" style="background: #ff9800; color: white; display: none;">üîÑ –°–±—Ä–æ—Å–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ</button>[m
             [m
         <div style="margin: 10px 0;">[m
             <button onclick="startCall('user1')" id="startCallBtn1" disabled style="background: #4CAF50; color: white; display: none;">üìû –ü–æ–∑–≤–æ–Ω–∏—Ç—å</button>[m
[31m-        <button onclick="resetBothUsers()" id="resetBtn1" style="background: #FF9800; color: white; display: inline-block;">üîÑ –°–±—Ä–æ—Å–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ</button>[m
[32m+[m[32m        <button onclick="resetBothUsers()" id="resetBtn1" style="background: #FF9800; color: white; display: none;">üîÑ –°–±—Ä–æ—Å–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ</button>[m
             <button onclick="testOffer1()" id="offerBtn1" disabled style="background: #2196F3; color: white; display: none;">üìû –ù–∞—á–∞—Ç—å –∑–≤–æ–Ω–æ–∫</button>[m
             <button onclick="startP2PCall()" id="p2pBtn1" disabled style="background: #9C27B0; color: white; display: none;">üìû –°–≤—è–∑—å</button>[m
             <button onclick="disconnectCall()" id="disconnectBtn1" disabled style="background: #f44336; color: white; display: none;">üîå –†–∞–∑–æ—Ä–≤–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ</button>[m
[36m@@ -51,8 +51,8 @@[m
             <input type="text" id="user2Id" value="user2" placeholder="User ID">[m
             <input type="text" id="user2Target" value="user1" placeholder="–¶–µ–ª–µ–≤–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å">[m
             <button onclick="startUser2()">–ó–∞–ø—É—Å—Ç–∏—Ç—å User 2</button>[m
[31m-            <button onclick="sendPingToTarget('user2')">–û—Ç–ø—Ä–∞–≤–∏—Ç—å ping –∫ —Ü–µ–ª–µ–≤–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é</button>[m
[31m-            <button onclick="resetUser2()" style="background: #ff9800; color: white;">üîÑ –°–±—Ä–æ—Å–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ</button>[m
[32m+[m[32m            <button onclick="sendPingToTarget('user2')" style="display: none;">–û—Ç–ø—Ä–∞–≤–∏—Ç—å ping –∫ —Ü–µ–ª–µ–≤–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é</button>[m
[32m+[m[32m            <button onclick="resetUser2()" style="background: #ff9800; color: white; display: none;">üîÑ –°–±—Ä–æ—Å–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ</button>[m
             [m
         <div style="margin: 10px 0;">[m
             <button onclick="startCall('user2')" id="startCallBtn2" disabled style="background: #4CAF50; color: white; display: none;">üìû –ü–æ–∑–≤–æ–Ω–∏—Ç—å</button>[m
[36m@@ -102,6 +102,7 @@[m
         [m
         // –ì–ª–æ–±–∞–ª—å–Ω—ã–π –∏–Ω–∏—Ü–∏–∞—Ç–æ—Ä —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è[m
         let globalInitiator = null;[m
[32m+[m[32m        let isResetting = false; // –§–ª–∞–≥ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥–≤–æ–π–Ω–æ–≥–æ —Å–±—Ä–æ—Å–∞[m
         [m
         let user1 = {[m
             id: 'user1',[m
[36m@@ -167,7 +168,7 @@[m
                 [m
                 // –ó–∞–ø—É—Å–∫–∞–µ–º polling –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤[m
                 if (user.interval) clearInterval(user.interval);[m
[31m-                user.interval = setInterval(() => checkSignals(user), 1000); // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É[m
[32m+[m[32m                user.interval = setInterval(() => checkSignals(user), 3000); // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã[m
                 checkSignals(user);[m
                 [m
                 // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è[m
[36m@@ -308,10 +309,29 @@[m
                     } else if (caller.peerConnection.connectionState === 'failed') {[m
                         caller.log('‚ùå P2P —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å', 'error');[m
                     } else if (caller.peerConnection.connectionState === 'disconnected') {[m
[31m-                        caller.log('üîå P2P —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∞–∑–æ—Ä–≤–∞–Ω–æ - —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ', 'warning');[m
[31m-                        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ —Ä–∞–∑—Ä—ã–≤–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è[m
[31m-                        resetUser1();[m
[31m-                        resetUser2();[m
[32m+[m[32m                        if (!isResetting) {[m
[32m+[m[32m                            caller.log('üîå P2P —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∞–∑–æ—Ä–≤–∞–Ω–æ - —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ—Ä–µ–∑ onconnectionstatechange', 'warning');[m
[32m+[m[32m                            isResetting = true;[m
[32m+[m[32m                            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ —Ä–∞–∑—Ä—ã–≤–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è[m
[32m+[m[32m                            resetUser1();[m
[32m+[m[32m                            resetUser2();[m
[32m+[m[32m                            globalInitiator = null;[m
[32m+[m[32m                            updateAllCallButtons();[m
[32m+[m[32m                            isResetting = false;[m
[32m+[m[32m                            caller.log('‚úÖ –°–±—Ä–æ—Å –∑–∞–≤–µ—Ä—à–µ–Ω —á–µ—Ä–µ–∑ onconnectionstatechange', 'success');[m
[32m+[m[41m                            [m
[32m+[m[32m                            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π[m
[32m+[m[32m                            user1.log('üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ user1 —á–µ—Ä–µ–∑ onconnectionstatechange...', 'info');[m
[32m+[m[32m                            user2.log('üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ user2 —á–µ—Ä–µ–∑ onconnectionstatechange...', 'info');[m
[32m+[m[41m                            [m
[32m+[m[32m                            // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–º[m
[32m+[m[32m                            setTimeout(() => {[m
[32m+[m[32m                                startUser(user1, 'user1Id', 'localVideo1');[m
[32m+[m[32m                                startUser(user2, 'user2Id', 'localVideo2');[m
[32m+[m[32m                            }, 1000);[m
[32m+[m[32m                        } else {[m
[32m+[m[32m                            caller.log('üîå P2P —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∞–∑–æ—Ä–≤–∞–Ω–æ - —Å–±—Ä–æ—Å —É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω —á–µ—Ä–µ–∑ disconnectCall', 'info');[m
[32m+[m[32m                        }[m
                     }[m
                 };[m
                 [m
[36m@@ -330,7 +350,7 @@[m
                 caller.log('‚úÖ Offer –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω, –æ–∂–∏–¥–∞–Ω–∏–µ answer', 'success');[m
                 [m
                 // –ó–∞–ø—É—Å–∫–∞–µ–º polling –¥–ª—è WebRTC —Å–∏–≥–Ω–∞–ª–æ–≤ (answer)[m
[31m-                caller.interval = setInterval(() => checkWebRTCSignals(caller), 1000);[m
[32m+[m[32m                caller.interval = setInterval(() => checkWebRTCSignals(caller), 3000);[m
                 caller.log(`üîÑ –ó–∞–ø—É—â–µ–Ω polling –¥–ª—è WebRTC —Å–∏–≥–Ω–∞–ª–æ–≤ (answer)`, 'info');[m
                 [m
             } catch (error) {[m
[36m@@ -843,12 +863,31 @@[m
                     user.log('‚úÖ P2P —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!', 'success');[m
                 } else if (user.peerConnection.connectionState === 'failed') {[m
                     user.log('‚ùå P2P —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å', 'error');[m
[31m-                } else if (user.peerConnection.connectionState === 'disconnected') {[m
[31m-                    user.log('üîå P2P —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∞–∑–æ—Ä–≤–∞–Ω–æ - —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ', 'warning');[m
[31m-                    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ —Ä–∞–∑—Ä—ã–≤–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è[m
[31m-                    resetUser1();[m
[31m-                    resetUser2();[m
[31m-                }[m
[32m+[m[32m                    } else if (user.peerConnection.connectionState === 'disconnected') {[m
[32m+[m[32m                        if (!isResetting) {[m
[32m+[m[32m                            user.log('üîå P2P —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∞–∑–æ—Ä–≤–∞–Ω–æ - —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ—Ä–µ–∑ onconnectionstatechange', 'warning');[m
[32m+[m[32m                            isResetting = true;[m
[32m+[m[32m                            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ —Ä–∞–∑—Ä—ã–≤–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è[m
[32m+[m[32m                            resetUser1();[m
[32m+[m[32m                            resetUser2();[m
[32m+[m[32m                            globalInitiator = null;[m
[32m+[m[32m                            updateAllCallButtons();[m
[32m+[m[32m                            isResetting = false;[m
[32m+[m[32m                            user.log('‚úÖ –°–±—Ä–æ—Å –∑–∞–≤–µ—Ä—à–µ–Ω —á–µ—Ä–µ–∑ onconnectionstatechange', 'success');[m
[32m+[m[41m                            [m
[32m+[m[32m                            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π[m
[32m+[m[32m                            user1.log('üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ user1 —á–µ—Ä–µ–∑ onconnectionstatechange...', 'info');[m
[32m+[m[32m                            user2.log('üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ user2 —á–µ—Ä–µ–∑ onconnectionstatechange...', 'info');[m
[32m+[m[41m                            [m
[32m+[m[32m                            // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–º[m
[32m+[m[32m                            setTimeout(() => {[m
[32m+[m[32m                                startUser(user1, 'user1Id', 'localVideo1');[m
[32m+[m[32m                                startUser(user2, 'user2Id', 'localVideo2');[m
[32m+[m[32m                            }, 1000);[m
[32m+[m[32m                        } else {[m
[32m+[m[32m                            user.log('üîå P2P —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∞–∑–æ—Ä–≤–∞–Ω–æ - —Å–±—Ä–æ—Å —É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω —á–µ—Ä–µ–∑ disconnectCall', 'info');[m
[32m+[m[32m                        }[m
[32m+[m[32m                    }[m
             };[m
         }[m
         [m
[36m@@ -945,7 +984,7 @@[m
                 }[m
                 [m
                 // –ó–∞–ø—É—Å–∫–∞–µ–º polling –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ disconnect —Å–∏–≥–Ω–∞–ª–æ–≤[m
[31m-                user.interval = setInterval(() => checkSignals(user), 1000);[m
[32m+[m[32m                user.interval = setInterval(() => checkSignals(user), 3000);[m
                 user.log(`üîÑ –ó–∞–ø—É—â–µ–Ω polling –¥–ª—è disconnect —Å–∏–≥–Ω–∞–ª–æ–≤`, 'info');[m
                 [m
                 // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è offer/answer –æ–±–º–µ–Ω–∞[m
[36m@@ -1101,10 +1140,12 @@[m
             [m
             user1.state = 'idle';[m
             user1.targetUser = null;[m
[32m+[m[32m            user1.log(`‚úÖ user1 —Å–±—Ä–æ—à–µ–Ω –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: ${user1.state}`, 'success');[m
             // globalInitiator –ù–ï —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –∑–¥–µ—Å—å - —ç—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –≤ disconnectCall[m
             [m
[31m-            document.getElementById('startCallBtn1').style.display = 'none';[m
[31m-            document.getElementById('startCallBtn1').disabled = true;[m
[32m+[m[32m            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–ü–æ–∑–≤–æ–Ω–∏—Ç—å" –¥–ª—è —Å–±—Ä–æ—à–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è[m
[32m+[m[32m            document.getElementById('startCallBtn1').style.display = 'inline-block';[m
[32m+[m[32m            document.getElementById('startCallBtn1').disabled = false;[m
             document.getElementById('offerBtn1').style.display = 'none';[m
             document.getElementById('offerBtn1').disabled = true;[m
             document.getElementById('p2pBtn1').style.display = 'none';[m
[36m@@ -1138,10 +1179,12 @@[m
             [m
             user2.state = 'idle';[m
             user2.targetUser = null;[m
[32m+[m[32m            user2.log(`‚úÖ user2 —Å–±—Ä–æ—à–µ–Ω –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: ${user2.state}`, 'success');[m
             // globalInitiator –ù–ï —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –∑–¥–µ—Å—å - —ç—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –≤ disconnectCall[m
             [m
[31m-            document.getElementById('startCallBtn2').style.display = 'none';[m
[31m-            document.getElementById('startCallBtn2').disabled = true;[m
[32m+[m[32m            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–ü–æ–∑–≤–æ–Ω–∏—Ç—å" –¥–ª—è —Å–±—Ä–æ—à–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è[m
[32m+[m[32m            document.getElementById('startCallBtn2').style.display = 'inline-block';[m
[32m+[m[32m            document.getElementById('startCallBtn2').disabled = false;[m
             document.getElementById('offerBtn2').style.display = 'none';[m
             document.getElementById('offerBtn2').disabled = true;[m
             document.getElementById('p2pBtn2').style.display = 'none';[m
[36m@@ -1157,6 +1200,12 @@[m
         }[m
         [m
         async function disconnectCall() {[m
[32m+[m[32m            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∏–¥–µ—Ç –ª–∏ —É–∂–µ —Å–±—Ä–æ—Å[m
[32m+[m[32m            if (isResetting) {[m
[32m+[m[32m                user1.log(`‚ö†Ô∏è –°–±—Ä–æ—Å —É–∂–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è`, 'warning');[m
[32m+[m[32m                return;[m
[32m+[m[32m            }[m
[32m+[m[41m            [m
             // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫—Ç–æ –Ω–∞–∂–∞–ª –∫–Ω–æ–ø–∫—É disconnect[m
             let caller = null;[m
             [m
[36m@@ -1173,12 +1222,21 @@[m
             }[m
             [m
             caller.log(`üîå –†–∞–∑—Ä—ã–≤–∞–µ–º P2P —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ (${caller.id})`, 'warning');[m
[32m+[m[32m            isResetting = true;[m
             [m
[31m-            // –ó–∞–∫—Ä—ã–≤–∞–µ–º PeerConnection - —ç—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–æ—Ä–≤–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É –æ–±–æ–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π[m
[32m+[m[32m            // –ó–∞–∫—Ä—ã–≤–∞–µ–º PeerConnection —É –æ–±–æ–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π[m
             if (caller.peerConnection) {[m
                 caller.peerConnection.close();[m
                 caller.peerConnection = null;[m
[31m-                caller.log(`üîå PeerConnection –∑–∞–∫—Ä—ã—Ç`, 'info');[m
[32m+[m[32m                caller.log(`üîå PeerConnection –∑–∞–∫—Ä—ã—Ç —É ${caller.id}`, 'info');[m
[32m+[m[32m            }[m
[32m+[m[41m            [m
[32m+[m[32m            // –ó–∞–∫—Ä—ã–≤–∞–µ–º PeerConnection —É –≤—Ç–æ—Ä–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è[m
[32m+[m[32m            const otherUser = caller.id === 'user1' ? user2 : user1;[m
[32m+[m[32m            if (otherUser.peerConnection) {[m
[32m+[m[32m                otherUser.peerConnection.close();[m
[32m+[m[32m                otherUser.peerConnection = null;[m
[32m+[m[32m                otherUser.log(`üîå PeerConnection –∑–∞–∫—Ä—ã—Ç —É ${otherUser.id}`, 'info');[m
             }[m
             [m
             // –û—á–∏—â–∞–µ–º —Å–∏–≥–Ω–∞–ª—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –¥–ª—è –æ–±–æ–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π[m
[36m@@ -1203,6 +1261,8 @@[m
             }[m
             [m
             // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–±–æ–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π[m
[32m+[m[32m            user1.log('üîÑ –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ user1 —á–µ—Ä–µ–∑ disconnectCall', 'info');[m
[32m+[m[32m            user2.log('üîÑ –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ user2 —á–µ—Ä–µ–∑ disconnectCall', 'info');[m
             resetUser1();[m
             resetUser2();[m
             [m
[36m@@ -1211,16 +1271,43 @@[m
             user1.log('üîÑ globalInitiator —Å–±—Ä–æ—à–µ–Ω', 'info');[m
             user2.log('üîÑ globalInitiator —Å–±—Ä–æ—à–µ–Ω', 'info');[m
             [m
[32m+[m[32m            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ idle[m
[32m+[m[32m            user1.log(`‚úÖ user1.state = ${user1.state}`, 'success');[m
[32m+[m[32m            user2.log(`‚úÖ user2.state = ${user2.state}`, 'success');[m
[32m+[m[41m            [m
             // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –¥–ª—è –æ–±–æ–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π[m
             updateAllCallButtons();[m
[32m+[m[41m            [m
[32m+[m[32m            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥ —Å–±—Ä–æ—Å–∞[m
[32m+[m[32m            isResetting = false;[m
[32m+[m[32m            user1.log('‚úÖ –°–±—Ä–æ—Å –∑–∞–≤–µ—Ä—à–µ–Ω —á–µ—Ä–µ–∑ disconnectCall', 'success');[m
[32m+[m[32m            user2.log('‚úÖ –°–±—Ä–æ—Å –∑–∞–≤–µ—Ä—à–µ–Ω —á–µ—Ä–µ–∑ disconnectCall', 'success');[m
[32m+[m[41m            [m
[32m+[m[32m            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π[m
[32m+[m[32m            user1.log('üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ user1...', 'info');[m
[32m+[m[32m            user2.log('üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ user2...', 'info');[m
[32m+[m[41m            [m
[32m+[m[32m            // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–º[m
[32m+[m[32m            setTimeout(() => {[m
[32m+[m[32m                startUser(user1, 'user1Id', 'localVideo1');[m
[32m+[m[32m                startUser(user2, 'user2Id', 'localVideo2');[m
[32m+[m[32m            }, 1000);[m
         }[m
         [m
         // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–±—Ä–æ—Å–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ–±–æ–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π[m
         function resetBothUsers() {[m
[32m+[m[32m            if (isResetting) {[m
[32m+[m[32m                user1.log(`‚ö†Ô∏è –°–±—Ä–æ—Å —É–∂–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è`, 'warning');[m
[32m+[m[32m                return;[m
[32m+[m[32m            }[m
[32m+[m[41m            [m
             user1.log('üîÑ –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–±–æ–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π', 'info');[m
[32m+[m[32m            isResetting = true;[m
             resetUser1();[m
             resetUser2();[m
             globalInitiator = null;[m
[32m+[m[32m            updateAllCallButtons();[m
[32m+[m[32m            isResetting = false;[m
             user1.log('‚úÖ –°–æ—Å—Ç–æ—è–Ω–∏–µ –æ–±–æ–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–±—Ä–æ—à–µ–Ω–æ', 'success');[m
         }[m
         [m
[36m@@ -1253,12 +1340,14 @@[m
                     activeUser.log('üìπ –õ–æ–∫–∞–ª—å–Ω—ã–π –ø–æ—Ç–æ–∫ –ø–æ–ª—É—á–µ–Ω –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω', 'success');[m
                 }[m
                 [m
[31m-                // –î–æ–±–∞–≤–ª—è–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–∫–∏ –∫ PeerConnection[m
[31m-                if (activeUser.localStream) {[m
[32m+[m[32m                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –ª–∏ —É–∂–µ —Ç—Ä–µ–∫–∏[m
[32m+[m[32m                if (activeUser.localStream && activeUser.peerConnection.getSenders().length === 0) {[m